var Begin=function(t){class e{constructor(t){this.json=t,this.NAME="Vote Deals",this.LS_KEY="voted-deals",this.TANDC="Vote Deals T & Cs",this.LOAD_DATA="load data",this.DATA_AVAILABLE="data available",this.FROM_INTERVAL="interval",this.FROM_INITIALIZE="initialize",this.SUBMIT="submit",this.VOTE_CLASS="-vote-btn",this.redirect="https://www.jumia.com.ng/customer/account/login/?return=https%3A%2F%2Fwww.jumia.com.ng%2Fsp-vote%2F",this.ID="vote_deals",this.FOCUS="focus",this.BUILD="build",this.RESET="reset",this.MS_INTV_BTW_FETCHES=.5,this.TAB_OFFSET=63,this.TAB_LISTENER="tab listener",this.FIRST_TAB="first tab",this.IN_SESSION="in session",this.AFTER_SESSION="after session",this.BTW_OR_B4_SESSION="between or before session",this.SET_STATE="set state",this.TABS_PER_PAGE=6,this.TIME_SLOTS_TO_DISPLAY=12,this.SKU_X_MARGIN=4,this.time_interval=null,this.minute_duration=parseInt(t.config.minute_duration_spot_the_difference),this.CURRENCY=t.config.currency,this.config=t.config,this.domain=t.domain,this.el=(t,e)=>e?e.querySelector(t):document.querySelector(t),this.all=(t,e)=>e?e.querySelectorAll(t):document.querySelectorAll(t),this.pad=t=>1==t.toString().length?"0"+t:t,this.endTime=t=>t+60*this.minute_duration*1e3,this.isAGroup=t=>0===t.new_price.length,this.skuRow=t=>this.el('.-sku_row[data-time="'+t+'"]'),this.skuRows=()=>this.all(".-sku_row"),this.tab=t=>this.el('.-tab[data-time="'+t+'"]'),this.live=(t,e)=>t.forEach((t=>t.classList[e]("-live"))),this.skuID=t=>t.category+"_"+t.sku+"_"+t.time,this.capitalize=t=>t[0].toUpperCase()+t.slice(1),this.oosByTime=t=>t.map((t=>this.skuRow(t).classList.add("-oos"))),this.getData=(t,e)=>t.json_list.filter((t=>t[e.key]===e.name)),this.isItMyTime=(t,e)=>+new Date(t.time)===parseInt(e),this.isPast=t=>Date.now()>t&&Date.now()>this.endTime(t),this.isFuture=(t,e)=>-1===e.indexOf(t),this.displayCondition=(t,e)=>e<this.TIME_SLOTS_TO_DISPLAY,this.digit=(t,e)=>0!==parseInt(t)?this.pad(t)+e:"",this.isATab=t=>t.classList.contains("-tab"),this.midnight=t=>t?new Date(t).setHours(0,0,0,0):(new Date).setHours(0,0,0,0),this.clone=t=>JSON.parse(JSON.stringify(t)),this.arrayList=t=>Array.from(Array(t).keys()),this.jsonFrLStorage=t=>JSON.parse(localStorage.getItem(t))||{},this.jsonToLStorage=(t,e)=>localStorage.setItem(t,JSON.stringify(e)),this.groupID=(t,e)=>this.id(t+"-"+this.fullDate(e).toLowerCase().split(" ").join("-"),"-")}times(t){var e=t.map((t=>+new Date(t.time)));return Array.from(new Set(e)).sort(((t,e)=>t-e))}group(t,e){return e.map((e=>{var s=t.filter((t=>this.isItMyTime(t,e)));return{time:e,skus:s}}))}assignColor(t,e,s){var i=Array.from(s).map((t=>parseInt(t.getAttribute("data-votes")))),a=Math.min(...i),r=Math.max(...i),n=i.filter(((t,e,s)=>s.indexOf(t)!==e)),o=t.querySelector(".-tags"),h=t.getAttribute("data-votes");parseInt(h)===r&&o.setAttribute("data-color","green"),parseInt(h)===a&&o.setAttribute("data-color","red"),-1!==n.indexOf(parseInt(h))&&o.setAttribute("data-color","orange")}pastAndFutureTimes(t){var e=t.filter(this.isPast),s=t.filter((t=>this.isFuture(t,e)));return{past:e,future:s}}additionalTimes(t){var e=t.future,s=t.past,i=this.addition(e,s);return e.length<this.TIME_SLOTS_TO_DISPLAY?i:[]}addition(t,e){for(var s=[],i=this.TIME_SLOTS_TO_DISPLAY-t.length;i>-1;i--){var a=e.length-1-i;s.push(e[a])}return s}timeUnits(t){var e=new Date(t);return{day:e.getDay(),month:e.getMonth(),date:e.getDate(),hr:e.getHours(),mn:e.getMinutes()}}twelveHrFormat(t,e){return 12===t?this.pad(t)+":"+this.pad(e)+"pm":t>12?this.pad(t-12)+":"+this.pad(e)+"pm":0===t?"12:"+this.pad(e)+"am":this.pad(t)+":"+this.pad(e)+"am"}dayDiff(t){var e=new Date(t).getDate();return(new Date).getDate()-e}sameMonth(t){return new Date(t).getMonth()===(new Date).getMonth()}date(t){var e=this.dayDiff(t);return 0===e&&this.sameMonth(t)?this.capitalize("today"):1===e&&this.sameMonth(t)?this.capitalize("yesterday"):-1===e&&this.sameMonth(t)?this.capitalize("tomorrow"):this.fullDate(t)}fullDate(t){var e=new Date(t),s=e.toLocaleDateString("en-US",{month:"short"});return e.toLocaleDateString("en-US",{weekday:"short"})+" "+s+" "+e.getDate()}toggleClass(t,e,s){t.forEach((t=>t.classList.remove(s))),e.classList.add(s)}price(t){const e=this.numFromStr(t);return this.CURRENCY+" "+parseInt(e).toLocaleString()}numFromStr(t){var e=t.match(/\d/g);return e?e.join(""):0}discount(t,e){var s=100*(parseInt(t)-parseInt(e))/parseInt(t);return isNaN(s)?"":"-"+Math.round(s)+"%"}replacePattern(t,e){var s=new RegExp(t,"g");return e.replace(s,"-")}id(t,e){var s=this.replacePattern("'",t),i=this.replacePattern("&",s),a=this.replacePattern("%",i),r=this.replacePattern(":",a);this.replacePattern(";",r);return r.toLowerCase().split(" ").join(e)}badge(t){var e=this.id(t.type,"_"),s=this.config[e+"_icon"],i="Generic"===t.type?"Limited Stock":t.type,a=s?`<img class="lazy-image" data-src="${s}" alt="sku_img"/>`:i;return s?`<div class="-tag -inlineblock -vamiddle -b-img -${this.id(t.type,"-")}">${a}</div>`:`<div class="-tag -inlineblock -vamiddle -${this.id(t.type,"-")}" style="background-color:${this.config[t.type]}">${a}</div>`}timeFormat(t){var e=this.timeUnits(t),s=this.twelveHrFormat(e.hr,e.mn);return this.date(t)+"'s "+s+" sale"}platform(){var t="ontouchstart"in window;return{banner:t?this.config[this.ID+"_mobile_banner"]:this.config[this.ID+"_desktop_banner"],live_link:t?this.config[this.ID+"_deeplink"]:this.domain.host+"/"+this.config.download_apps_page}}show(t){return this.image_observer=new feature_box.ImageObserver(t),this.image_observer=null,this}}class s extends e{constructor(t){super(t),this.tab_bounds={},this.tabs=this.el(".-all-tabs"),this.tabs_parent=this.el(".-tabs"),this.prev=this.el(".-control.-prev"),this.next=this.el(".-control.-next"),feature_box.subscribe(this.BUILD,this.build.bind(this)),this.tabs.addEventListener("click",this.tabListener.bind(this))}reset(){this.tab_bounds={},this.tabs.innerHTML=""}build(t){this.reset();var e=t.reordered_times;this.tabs.innerHTML=e.map(this.createTab.bind(this)).join(""),e.map(this.tabBounds.bind(this));var s=this.all(".-tab")[0];this.setTabProps(s,this.FIRST_TAB),this.show(this.tabs),!1===feature_box.is_mobile&&this.scrollListener()}scrollListener(){this.next.addEventListener("click",this.scrollToNext.bind(this)),this.prev.addEventListener("click",this.scrollToPrev.bind(this))}scrollToNext(){var t=this.tabs.scrollLeft+50,e=this.tabs.scrollLeft+300-t;this.tabs.scrollLeft=t+1*e}scrollToPrev(){var t=this.tabs.scrollLeft-50,e=this.tabs.scrollLeft-300-t;this.tabs.scrollLeft=t+1*e}tabListener(t){var e=t.target.parentElement;this.isATab(e)&&this.setTabProps(e,this.TAB_LISTENER)}setTabProps(t,e){this.toggleClass(this.all(".-tab"),t,"active"),e==this.TAB_LISTENER&&feature_box.emit(this.FOCUS,t.getAttribute("data-time"))}tabBounds(t,e){var s=this.el('.-tab[data-time="'+t+'"]');this.tab_bounds[t]=s.getBoundingClientRect()}createTab(t,e){var s=0===e?"-tab active -inlineblock -posrel -vamiddle":"-tab -inlineblock -posrel -vamiddle",i=this.timeUnits(t);return`<a href="#top" class="${s}" data-time="${t}"><span class="-posabs -preloader -loading"></span><span class="-time">${this.twelveHrFormat(i.hr,i.mn)}</span><span>${this.date(t)}</span></a>`}}class i extends e{constructor(t){super(t),this.initialize()}initialize(){this.row_bounds={},this.user={},this.loggedIn=!1,this.lsVotes=this.jsonFrLStorage(this.LS_KEY),this.skus_el=this.el(".-skus"),this.loginCondition(),feature_box.subscribe(this.FOCUS,this.inFocus.bind(this)),feature_box.subscribe(this.BUILD,this.display.bind(this)),this.skus_el.addEventListener("click",this.vote.bind(this))}updateUiFromLocalStorage(){Object.keys(this.lsVotes).map((t=>{var e=this.lsVotes[t];if(e){var s=document.getElementById(e);this.updateUiByVote({sku:s,id:e,clicked:!1})}}))}vote(t){var e=t.target;if(e.classList.contains(this.VOTE_CLASS)){var s=e.parentElement,i=s.getAttribute("id"),a={id:i,email:this.user.email};feature_box.emit(this.SUBMIT,a),this.updateUiByVote({sku:s,skuID:i,clicked:!0}),this.jsonToLStorage(this.LS_KEY,this.lsVotes)}}updateUiByVote({sku:t,skuID:e,clicked:s}){var i=this.el(".-cta",t),a=t.parentElement,r=a.getAttribute("data-group-id"),n=this.all(".-sku",a),o=this.el(".-count",t),h=parseInt(o.textContent.split(" ")[0]);this.lsVotes[r]===e?(s&&(this.lsVotes[r]=null),a.classList.remove("-voted"),i.textContent="vote",h-=1):(s&&(this.lsVotes[r]=e),a.classList.add("-voted"),i.textContent="unvote",h+=1),o.textContent=this.voteTxt(h),t.setAttribute("data-votes",h),n.forEach(((t,e,s)=>{t.classList.remove("-sku-voted"),this.assignColor(t,e,s)})),t.classList.add("-sku-voted")}reset(){this.row_bounds={},this.skus_el.innerHTML=""}inFocus(t){var e=this.skuRows(),s=this.skuRow(t);this.toggleClass(e,s,"active")}display(t){this.reset(),this.displaySKUs(t),this.updateUiFromLocalStorage()}displaySKUs(t){this.skus_el.innerHTML=t.grouped_skus.map(this.rowHTML.bind(this)).join("");var e=this.all(".-sku_row")[0].getAttribute("data-time");this.inFocus(e),feature_box.emit(this.FOCUS,e),this.show(this.skus_el)}loginCondition(){if(/loaded|complete/.test(document.readyState)){clearInterval(this.everything_loaded);var t=store.customer.email;this.user={email:t},this.loggedIn=t.length>0}}login(t){t.add("-loggedin"),this.init(this.FROM_LOGIN)}rowHTML(t,e){var s=t.skus.map((t=>t.category)),i=(s=[...new Set(s)]).reduce(((e,s)=>(e[s]=t.skus.filter((t=>t.category===s)),e)),{}),a=this.createSections(i);return this.createRow(t,e,a)}createSections(t){return Object.keys(t).map((e=>this.sectionHTML(t[e],e))).join("")}voteTxt(t){return`${t} vote(s)`}sectionHTML(t,e){var s=t[0],i=`<div class="-section" data-group-id="${this.groupID(s.category,s.time)}"><div class="-title">${e}</div>`;return i+=t.map(this.singleHTML.bind(this)).join(""),i+="</div>"}voteHTML(t){return`<div class="-inlineblock -vamiddle -arrow"></div><div class="-inlineblock -vamiddle -count">${this.voteTxt(t)}</div>`}isLoggedIn(){return this.loggedIn}singleHTML(t){var e=this.price(t.old_price),s=this.price(t.new_price),i=this.discount(t.old_price,t.new_price),a=this.isLoggedIn()?`<div class="-cta -posabs ${this.VOTE_CLASS}">vote</div>`:`<a class="-redirect -posabs" href="${this.redirect}">log in</a>`;return`<div class="-sku -posrel" data-votes="0" id="${this.skuID(t)}" data-time="${t.time}" data-sku="${t.sku}" data-category="${t.category}"><a href="${t.pdp}" class="-img -posabs"><div class="-posabs -shadow"><span class="-posabs">voted</span></div><img class="lazy-image loaded" data-src="${t.image}" alt="sku_img"/><div class="-preloader -posabs"></div></a><div class="-details -posabs"><div class="-name">${t.name}</div><div class="-desc">${t.desc}</div><div class="-prices"><div class="-price -new">${s}</div><div class="-price -old">${e}</div></div><div class="-discount -price -posabs">${i}</div></div>${a}<div class="-tags -posabs" data-color="orange">${this.voteHTML(0)}</div></div>`}createRow(t,e,s){return`<div class="${0===e?"-sku_row -posrel active":"-sku_row -posrel"}" data-time="${t.time}">${s}</div>`}}class a extends e{constructor(t){super(t),this.time_el=this.el(".-countdown-row .-time"),this.sessionEnded=t=>t.t<=0||t.session_state===this.AFTER_SESSION,this.amIInSession=t=>Date.now()>=t&&Date.now()<this.endTime(t),this.amIPastSession=t=>Date.now()>this.endTime(t),feature_box.subscribe(this.FOCUS,this.inFocus.bind(this))}inFocus(t){var e=parseInt(t),s=this.endTime(e),i=this.sessionState(e);i===this.IN_SESSION&&this.liveActions(e);this.IN_SESSION;this.markSoldSKUs()}markSoldSKUs(){var t=Array.from(this.all(".-sku_row")).map((t=>parseInt(t.getAttribute("data-time")))),e=this.pastAndFutureTimes(t).past;this.oosByTime(e)}sessionState(t){var e="",s=this.amIInSession(t),i=this.amIPastSession(t);return e=s?this.IN_SESSION:"",""===(e=i?this.AFTER_SESSION:e)?this.BTW_OR_B4_SESSION:e}liveActions(t){var e=this.skuRow(t),s=this.tab(t);this.live([e,s],"add")}}class r extends e{constructor(t){super(t),this.comingTimes=()=>this.times().filter((t=>this.timeElapsedSinceMidnight()<t)),this.timeElapsedSinceMidnight=()=>new Date-new Date(this.midnight()),this.nextTime=()=>+new Date(this.midnight())+this.comingTimes()[0],this.initializeClock=t=>this.time_interval=setInterval((()=>this.toUpdateClock(t)),1e3),this.minuteToMillisecs=t=>60*t*1e3,this.clock_el=this.el("#clock"),this.reset()}reset(){this.minutes_in_a_day=1440,this.minutes_in_ms=6e4,clearInterval(this.time_interval);var t=this.nextTime();this.initializeClock(t)}toUpdateClock(t){var e=this.remainingTime(t);e.t<=0&&(this.reset(),feature_box.emit(this.LOAD_DATA,this.FROM_INTERVAL)),this.clock_el.innerHTML=`${("0"+e.minutes).slice(-2)}m : ${("0"+e.seconds).slice(-2)}s`}remainingTime(t){var e=+new Date(t)-+new Date,s=Math.floor(e/1e3%60),i=Math.floor(e/1e3/60%60),a=Math.floor(e/36e5%24);return{t:e,days:Math.floor(e/864e5),hours:a,minutes:i,seconds:s}}times(){var t=Math.round(this.minutes_in_a_day/this.MS_INTV_BTW_FETCHES);return this.arrayList(t).map((t=>{var e=t+1;return(this.MS_INTV_BTW_FETCHES*e-this.MS_INTV_BTW_FETCHES)*this.minutes_in_ms}))}}class n extends e{constructor(t){super(t),this.regExReplace=t=>t.replace(/\"|\,/g,""),this.clone=t=>JSON.parse(JSON.stringify(t)),this.initialize()}initialize(){this.configs_str=["projectId==jumia-d080c|messagingSenderId==877411630892|apiKey==AIzaSyCUP5ISID9Jh7-lm5R0k-HcOopqt8u-eyk|appId==1:877411630892:web:f7b7a9d6bbcfadb2","projectId==jumia-og|messagingSenderId==502706301371|apiKey==AIzaSyAT9KiJMaEGcMK1F87-eanWtE-z0_-Lw2s|appId==1:502706301371:web:79fea8a63ea2581c567c9e","projectId==jumia-bmtn2|messagingSenderId==875946805177|apiKey==AIzaSyAPvFJ9vtXynxudD9a-D7yhhEl-2rvEctA|appId==1:875946805177:web:a4adeca0b15e6b38","projectId==jumia-br|messagingSenderId==114843399424|apiKey==AIzaSyCg3xSlGNcHzxpHq05HPwN0IpRw5JnKc74|appId==1:114843399424:web:1a5b9cb9aa574f579cefe5","projectId==jumia-stor|messagingSenderId==659989278147|apiKey==AIzaSyB1N3LqxTcLPldBjKkQiiTJR8wy4f7IbJM|appId==1:659989278147:web:25d4693699d8aa0d","projectId==jumia-89cc5|messagingSenderId==650879520928|apiKey==AIzaSyCBK409LGgtZk-RI9VXDQrHe8_FGo9lFeo|appId==1:650879520928:web:a603d1d6a8904b5e","projectId==jumia-brnk|messagingSenderId==632015048847|apiKey==AIzaSyAfQc3JLSluNogTDwiHXy_pLJHmRd3Ufxw|appId==1:632015048847:web:34f74684ef297532"],this.configs=this.configs_str.map(this.strToJSON.bind(this)).map(this.configObj.bind(this)).map(this.firestore.bind(this)),feature_box.subscribe(this.LOAD_DATA,this.load.bind(this)),feature_box.subscribe(this.SUBMIT,this.submit.bind(this)),this.db_idx=0}submit(t){var e={},s={};e[t.email]=Date.now(),s[t.id]=e,this.configs.map((t=>{this.save(t.firestore,s).then((t=>{})).catch((t=>{}))}))}load(t){var e=this.dbIdx(t),s=this.configs[e];this.get(s.firestore,this.ID).then(this.showVotes.bind(this)).catch((t=>{}))}showVotes(t){var e=[];Object.keys(t).map((s=>{var i=this.extractData(t,s);return e.push(i.groupId),this.displayVotes(i),i}));document.querySelectorAll(".-section").forEach((t=>{t.querySelectorAll(".-sku").forEach(this.assignColor.bind(this))}))}extractData(t,e){var s=e.split("_"),i=s[0],a=s[1],r=s[2];return{sku:a,time:r,category:i,votes:Object.keys(t[e]).length,groupId:this.groupID(i,r)}}displayVotes(t){var e=t.votes,s=this.skuID(t),i=document.getElementById(s.toString());i.querySelector(".-count").textContent=e+" vote(s)",i.setAttribute("data-votes",e)}dbIdx(t){return t===this.FROM_INTERVAL?(this.db_idx++,this.db_idx>=this.configs.length?0:this.db_idx):this.db_idx}configObj(t){var e=this.clone(t),s=t.projectId+".firebaseapp.com",i="https://"+t.projectId+".firebaseio.com",a=t.projectId+".appspot.com";return Object.assign(e,{authDomain:s,databaseURL:i,storageBucket:a})}firestore(t){var e=firebase.initializeApp(t,t.projectId);return Object.assign(t,{firestore:e.firestore()})}strToJSON(t){return this.regExReplace(t).split("|").reduce(this.reduceProp.bind(this),{})}reduceProp(t,e){var s=e.split("==");return t[s[0]]=s[1]?s[1].toLocaleString():s[1],t}save(t,e){return t.collection(this.ID).doc("data").set(e,{merge:!0})}get(t,e){return t.collection(e).doc("data").get().then((t=>t.exists?t.data():{})).catch((t=>{}))}}new class extends e{constructor(t){super(t),this.database=new n(t),this.time=new r(t),this.database.load(this.FROM_INITIALIZE),this.data=this.getData(t,{key:"initiative",name:this.NAME}),this.tandcs=this.getData(t,{key:"type",name:this.TANDC}),this.tandc_el=this.el(".-re.-rules"),this.hiw_cta=document.querySelector(".-how-it-works"),this.hiw_cta.addEventListener("click",this.toggleBanner.bind(this)),this.top_banner=document.querySelector(".-banner.-top"),this.tabs=new s(t),this.sku_rows=new i(t),this.state=new a(t),feature_box.subscribe(this.RESET,this.init.bind(this)),this.init("from start").setBanner().displayTAndCs()}init(t){var e=this.times(this.data),s=this.pastAndFutureTimes(e),i=this.additionalTimes(s).filter((t=>void 0!==t)),a=s.future.concat(i),r=this.group(this.data,a);return feature_box.emit(this.BUILD,{reordered_times:a,grouped_skus:r}),this}toggleBanner(){this.top_banner.classList.toggle("-show");var t=this.hiw_cta.querySelector(".-txt");t.textContent="How It Works (T&Cs)"===t.textContent?"Close":"How It Works (T&Cs)"}setBanner(){return this.el(".-banner.-top img.lazy-image").setAttribute("data-src",this.platform().banner),this}displayTAndCs(){return this.tandc_el.innerHTML=this.tandcs.map(this.tandcHTML.bind(this)).join(""),this}tandcHTML(t){return`<div class="-rule_element"><div class="-inlineblock -vatop -num">${t.sku}.</div><div class="-inlineblock -vatop -desc">${t.name}</div></div>`}}(t)},gsheet_id="16AmKgEy2tHWRHgt9wdAfQJvgsML_pu_Z9PTH-_LvSjY",fb_config={apiKey:"AIzaSyAA8dQEt-yZnDyY3Lra8lndRJ3LWNYVW0o",authDomain:"jumia-c15a3.firebaseapp.com",databaseURL:"https://jumia-c15a3.firebaseio.com",projectId:"jumia-c15a3",storageBucket:"jumia-c15a3.appspot.com",messagingSenderId:"295115190934",appId:"1:295115190934:web:de0b33b53a514c3c"},element_id="app",feature_box=Featurebox({id:gsheet_id,config:fb_config,element_id:element_id,name:"vote_deals"});feature_box.subscribe(feature_box.FETCHED_DATA,Begin);