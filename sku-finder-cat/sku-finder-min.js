class Util{constructor(){this.rem_content=["Home & Office/Office Products/Packaging Materials","Fashion/Men's Fashion/Clothing/Underwear","Women's Fashion/Clothing/Lingerie, Sleep & Lounge","Health & Beauty/Sexual Wellness","Fashion/Women's Fashion/Underwear & Sleepwear","Fashion/Women's Fashion/Maternity","Fashion/Women's Fashion/Clothing/Swimsuits & Cover Ups","Women's Fashion/Clothing/Socks & Hosiery","Sporting Goods/Sports & Fitness/Exercise & Fitness","Home & Office/Arts, Crafts & Sewing/Sewing/Sewing Notions & Supplies/Dress Forms & Mannequins/Mannequins"],this.image_observer=null,this.el=t=>document.querySelector(t),this.all=t=>document.querySelectorAll(t),this.withinString=(t,e)=>0!==e&&e!==t.length-1,this.fetched=this.el(".-fetched")}collect(t,e){return fetch(t).then((t=>t.text())).then((t=>this["get"+e](t))).catch((t=>{}))}debounce(t,e){var s=null;return function(){var i=this,r=arguments;clearTimeout(s),s=setTimeout((()=>{t.apply(i,r)}),e)}}getContent(t){var e=t.indexOf("<main"),s=t.lastIndexOf("</main>"),i=t.substring(e,s+7);this.fetched.innerHTML=i;var r=this.contentFromHTML();return this.fetched.innerHTML="",r}contentFromHTML(){var t=this.all(".col4.-pvm");return Array.from(t).map((t=>this.getL1L2s(t)))}getL1L2s(t){var e=t.querySelector(".-pbm.-m.-upp.-hov-or5"),s=e.getAttribute("href");return{L1_name:e.textContent,L1_href:s,L2s:this.getL2s(t)}}getL2s(t){var e=t.querySelectorAll(".-gy5.-hov-m.-hov-gy8");return Array.from(e).map((t=>{var e=t.getAttribute("href");return{L2_name:t.textContent,L2_href:e}}))}escape(t){return t.replace(/[-\/\\^$*+?.()|[\]{}]/g,"\\$&")}braceIndices(t,e){for(var s,i=new RegExp(e,"gi"),r=[];s=i.exec(t);)r.push(s.index);return r}products(t){this.fetched.innerHTML=t;var e=[],s=this.fetched.querySelectorAll("script");this.fetched.innerHTML="",s.forEach((t=>e.push(t.innerHTML)));var i=e.findIndex((t=>-1!==t.indexOf('"products":[{')));return e[i]}mobile(t){var e=t.indexOf('"products":'),s="{"+t.substring(e,t.length),i=s.indexOf(',"head"');return s.substring(0,i-1)+"}"}desktop(t){var e=t.indexOf('"products":'),s="{"+t.substring(e,t.length),i=this.braceIndices(s,this.escape("}]")),r=i[i.length-1];return s.substring(0,r+2)+"}"}format(t){return innerWidth>600?this.desktop(t):this.mobile(t)}extractProducts(t){var e=this.products(t);return this.format(e)}getProducts(t){localStorage.setItem("sku-finder",t);var e=this.extractProducts(t),s=JSON.parse(e).products;return s?{raw:t,filtered:this.filterProducts(s)}:{raw:t,filtered:[]}}doesntHaveDiscount(t){var e=t.filter((t=>!0===t.isBuyable));return 0!==e.length?e:[]}hasDiscount(t){var e=t.filter((t=>{var e=t.prices.discount;return e&&parseInt(e)>0})).sort(((t,e)=>{var s=parseInt(t.prices.discount);return parseInt(e.prices.discount)-s}));return 0!==e.length?e:[]}filterProducts(t){return this.doesntHaveDiscount(t)}toInclude(t){return-1===this.rem_content.indexOf(t.categories)}replacePattern(t,e){var s=new RegExp(t,"g");return e.replace(s,"-")}id(t,e){var s=this.replacePattern("'",t),i=this.replacePattern("&",s);return this.replacePattern("%",i).toLowerCase().split(" ").join(e)}lazyLoad(){this.image_observer=new ImageObserver,this.image_observer=null}}class SKUCollector{constructor(t){this.util=t,this.PRODUCTS="Products",this.CONTENT="Content",this.fetchCount=0,this.MAX_FETCH_COUNT=10,this.visibleSKUs=5,this.prevSearch="",this.skuCats=[],this.skus=[],this.data=[],this.unsorted_data=[],this.original=[],this.last_page=0,this.url="",this.current_page=1,this.valid=0,this.oos=0,this.temp_valid=0,this.temp_oos=0,this.searchInput=this.util.el(".-productsearch"),this.preloader=this.util.el("#preloader"),this.preview_preloader=this.util.el("#preview-preloader"),this.productfloorsS=this.util.el(".-product_floors.-search_floor"),this._productSection=this.util.el(".-product-section"),this.textarea_c=this.util.el("#copy"),this.textarea_n=this.util.el("#copy-excel"),this.page_no=this.util.el("#page-no"),this.start=this.util.el("#find-btn"),this.preview_skus=this.util.el("#preview-skus"),this.shuffle_skus=this.util.el("#shuffle-skus"),this.status=this.util.el(".-status"),this.sort_status=this.util.el(".-sort-status"),this.products_el=this.util.el(".-search_floor .-products"),this.discount_filter=this.util.el("#discount-filter"),this.rating_filter=this.util.el("#rating-filter"),this.category_filter=this.util.el("#category-filter"),this.oos_filter=this.util.el("#oos-filter"),this.sort_by=this.util.el("#sort-by"),this.sort_by_stock=this.util.el("#sort-by-stock"),this.sort_by_stock_wrap=this.util.el(".-sort.-by-stock"),this.type=this.util.el("#type"),this.find_control=this.util.el(".-find.-control"),this.preview_control=this.util.el(".-preview.-control"),this.controls=this.util.all(".-right .-control"),this._imageObserver=null,this.topcontrol=this.util.el(".-left .-top-control"),this.country=this.util.el("#country"),this.copy_btns=this.util.all(".-copy-btn"),this.FLAGS=[{flag:!1,txt:"find"},{flag:!0,txt:"preview"}],this.current_state=this.FLAGS[0],this.textareas=[".-comma",".-newline"],this.comma="comma",this.newline="newline",this.PD="preview_delete",this.query=t=>".-"+t,this.sku_url="https://www.jumia"+this.country.value+"/catalog/?q=",this.domain="https://www.jumia"+this.country.value,this.default_url="https://jumia.com.ng/mlp-holiday-sale-h-home-revamp",this.category_url="/index/allcategories/",this.listeners(),this.VALID_OOS="valid-oos",this.DISCOUNT="discount",this.RATING="rating",this.PRICE="price",this.CATEGORY="categories",this.categories=[],this.sort_factor=this.PRICE,this.L1L2Categories()}L1L2Categories(){var t=this.domain+this.category_url;this.util.collect(t,this.CONTENT).then((t=>this.categories=t)).catch((t=>{}))}listeners(){this.start.addEventListener("click",(()=>this.begin())),this.discount_filter.addEventListener("change",(()=>{this.sort_factor=this.DISCOUNT,this.resetFilter(this.rating_filter),this.resetFilter(this.oos_filter),this.resetFilter(this.category_filter),this.resetFilter(this.sort_by),this.sort_status.textContent="SKUS will be sorted by "+this.sort_factor,this.filter({range:this.discount_filter.value,type:this.DISCOUNT})})),this.rating_filter.addEventListener("change",(()=>{this.sort_factor=this.RATING,this.resetFilter(this.discount_filter),this.resetFilter(this.oos_filter),this.resetFilter(this.category_filter),this.resetFilter(this.sort_by),this.sort_status.textContent="SKUS will be sorted by "+this.sort_factor,this.filter({range:this.rating_filter.value,type:this.RATING})})),this.oos_filter.addEventListener("change",(()=>{this.sort_factor=this.PRICE,this.resetFilter(this.discount_filter),this.resetFilter(this.rating_filter),this.resetFilter(this.category_filter),this.resetFilter(this.sort_by),this.sort_status.textContent="SKUS will be sorted by "+this.sort_factor,this.filter({value:this.oos_filter.value,type:this.VALID_OOS})})),this.sort_by.addEventListener("change",(()=>this.sort(this.sort_by.value))),this.sort_by_stock.addEventListener("change",(()=>this.sort(this.sort_by_stock.value,!0))),this.type.addEventListener("click",(()=>{this.switchControl()})),this.attachBinder(),this.preview_skus.addEventListener("click",(()=>{this.previewSKUs()})),this.shuffle_skus.addEventListener("click",(()=>{this.shuffleSKUs()})),this.country.addEventListener("change",(()=>{this.reset(),this.sku_url="https://www.jumia"+this.country.value+"/catalog/?q=",this.domain="https://www.jumia"+this.country.value})),this.copy_btns.forEach((t=>{t.addEventListener("click",(()=>{var e=t.parentElement.querySelector("textarea");this.clipboard(t,"copy",e)}))})),this.textarea_c.setAttribute("placeholder","copy skus...\nCU005FC0IQMTPNAFAMZ,TS657EA0HUFVQNAFAMZ..."),this.textarea_n.setAttribute("placeholder","copy skus...\nCU005FC0IQMTPNAFAMZ\nTS657EA0HUFVQNAFAMZ...")}categoryListener(){this.category_filter.addEventListener("change",(()=>{this.sort_factor=this.CATEGORY,this.resetFilter(this.discount_filter),this.resetFilter(this.rating_filter),this.resetFilter(this.oos_filter),this.resetFilter(this.sort_by),this.sort_status.textContent="SKUS will be sorted by "+this.sort_factor,this.filter({el:this.category_filter,type:this.CATEGORY})}))}clipboard(t,e,s){s.select(),document.execCommand(e),t.classList.add("-clicked"),setTimeout((()=>{t.classList.remove("-clicked")}),800)}shuffleSKUs(){this.data.sort((()=>.5-Math.random()));var t=this.data.map((t=>t.sku));this.update(t),this.attach()}previewSKUs(){0===this.skus.length?alert("paste skus in the textareas below in their respective formats"):(this.skus=this.skus.filter((t=>""!==t)),this.collectSKUData().then((t=>{this.preview_preloader.classList.remove("-loading"),this.data=[],this.data=t.filter((t=>void 0!==t)),this.buildCategoryFilter(),this.attach()})).catch((t=>{this.preview_preloader.classList.remove("-loading"),this.attach()})))}collectSKUData(){return this.valid=0,this.temp_valid=this.valid,this.preview_preloader.classList.add("-loading"),Promise.all(this.skus.map((t=>{var e=this.sku_url+t;return this.util.collect(e,this.PRODUCTS).then((t=>(this.valid++,this.temp_valid=this.valid,this.oos=this.skus.length-this.valid,this.temp_oos=this.oos,this.updateStatus(this.valid,this.oos,this.skus.length),t.filtered[0]))).catch((e=>(this.valid--,this.temp_valid=this.valid,{sku:t,name:"out of stock",brand:"oos",sellerId:0,isShopGlobal:!0,categories:"out of stock",prices:{rawPrice:"0",price:"N 0,000",priceEuro:"0",taxEuro:"0",oldPrice:"0",oldPriceEuro:"0",discount:"0"},stock:{percent:0,text:"0 items left"},rating:{average:0,totalRatings:0},image:"https://ng.jumia.is/cms/0-1-weekly-cps/onsite-report/floor-product-templatev2.jpg",url:"/catalog/?q="+t,isBuyable:!0,shopGlobal:{identifier:"global",name:"Shipped from abroad"},selectedVariation:t})))})))}attachBinder(){var t=this.util.el(this.query(this.comma)),e=this.util.el(this.query(this.newline)),s={el:e,symbol:"\n"},i={el:t,symbol:","};e.addEventListener("keyup",(()=>{this.edit(s,i)})),t.addEventListener("keyup",(()=>{this.edit(i,s)}))}edit(t,e){this.bindTextareas(t,e),this.updateSKUList()}updateSKUList(){var t=this.util.el(this.query(this.comma));this.skus=t.value.split(",")}bindTextareas(t,e){var s=t.el.value.split(t.symbol).join(e.symbol);e.el.value=s}switchControl(){var t=this.FLAGS.filter((t=>t.flag===this.type.checked))[0];this.switch(t),this.reset(),this.updateStatus(0,0,this.skus.length)}switch(t){this.current_state=t,this.topcontrol.setAttribute("data-action",t.txt);var e="find"===t.txt?"copy":"paste";this.textarea_c.setAttribute("placeholder",e+" skus...\nCU005FC0IQMTPNAFAMZ,TS657EA0HUFVQNAFAMZ..."),this.textarea_n.setAttribute("placeholder",e+" skus...\nCU005FC0IQMTPNAFAMZ\nTS657EA0HUFVQNAFAMZ...")}filter(t){this.data=this.subset(t),this.processUpdate()}processUpdate(){this.skus=this.data.map((t=>t.sku)),this.update(this.skus),this.statusCheckAndUpdate(),this.preRender(),this.render(this.data),this.listener()}sortByValue(t){return this.data.sort(((e,s)=>{e=this.sortObj(e),s=this.sortObj(s);return"asc"===t?e[this.sort_factor]-s[this.sort_factor]:s[this.sort_factor]-e[this.sort_factor]}))}sortByStock(t){return this.data.sort(((e,s)=>{var i=e.stock.text.split(" ")[0],r=s.stock.text.split(" ")[0];return"asc"===t?parseInt(i)-parseInt(r):parseInt(r)-parseInt(i)}))}sort(t,e){this.data="0"!==t?e?this.sortByStock(t):this.sortByValue(t):this.unsorted_data,this.processUpdate()}sortObj(t){return{price:this.newPrice(t.prices.price),discount:parseFloat(t.prices.discount),rating:parseFloat(t.rating.average),category:t.categories.split("/")}}newPrice(t){var e=t.split("-")[0].trim().split(" ")[1].replace(",","");return parseFloat(e)}statusCheckAndUpdate(t){t!==this.PD&&(this.temp_oos=this.oos,this.temp_valid=this.valid);var e=this.temp_oos,s=this.temp_valid;"find"===this.current_state.txt?this.updateStatus(this.current_page,this.last_page,this.skus.length):this.updateStatus(s,e,this.skus.length)}subset(t){switch(t.type){case this.VALID_OOS:return this.validOrOOS(t);case this.CATEGORY:return this.categoryFilter(t);default:return this.rangeFilter(t)}}buildCategoryFilter(){var t=this.data.map((t=>t.categories.split("/")[0])),e=[...new Set(t)],s='<option selected value="0">Category...</option>';e.map((t=>{s+=`<option data-href="${this.categoryLink(t).L1_href}" value="${t}">${t}</option>`})),this.category_filter.innerHTML=s,this.categoryListener()}categoryLink(t){return this.categories.find((e=>e.L1_name===t))||{}}categoryFilter(t){var e=t.el.value;t.el.getAttribute("data-href");return this.original.filter((t=>{var s=t.categories.split("/")[0];return e===s}))}rangeFilter(t){var e=t.range.split("-"),s=t.type,i=parseInt(e[0]),r=parseInt(e[1]);return 0===i&&0===r?this.original.filter((t=>0===t.rating.average)):isNaN(r)?this.original:this.original.filter((t=>{if("discount"===s){var e=parseInt(t.prices.discount);return e>=i&&e<r}if("rating"===s){var a=parseFloat(t.rating.average);return a>=i&&a<r}}))}validOrOOS(t){var e=t.value;return this.original.filter((t=>"oos"===e?"oos"===t.brand:"oos"!==t.brand))}reset(){this.skus=[],this.data=[],this.original=[],this.last_page=1,this.url="",this.current_page=1,this.textarea_c.value="",this.textarea_n.value="",this.products_el.innerHTML="",this.resetFilter(this.discount_filter),this.resetFilter(this.rating_filter),this.resetFilter(this.oos_filter),this.resetFilter(this.category_filter),this.resetFilter(this.sort_by)}resetFilter(t){var e=t.querySelectorAll("option");e.forEach((t=>t.selected=!1)),e[0].selected=!0,t.value=e[0].getAttribute("value")}begin(){this.reset();var t=this.searchInput.value,e=parseInt(this.page_no.value),s=this.isValidUrl(t),i=!isNaN(e)&&e>0;!s&&alert("Enter a valid url"),!i&&alert("Enter a valid number from 1"),s&&i&&(this.url=t,this.last_page=e,this.updateData())}updateData(){var t=this.url.indexOf("#catalog-listing");this.url=-1===t?this.url:this.url.substring(0,t);var e=this.url+(-1===this.url.indexOf("?")?"?page=":"&page=")+this.current_page;this.collect(e)}collect(t){return t?(this.preloader.classList.add("-loading"),this.util.collect(t,this.PRODUCTS).then((t=>this.attachData(t.filtered))).then((t=>this.update(this.skus))).then((t=>this.buildCategoryFilter())).catch((e=>this.unsuccessful(e,t)))):Promise.resolve([])}attach(){this.original=[],this.data.map((t=>this.original.push(t))),this.preRender(),this.render(this.original)}preRender(){this.unsorted_data=JSON.parse(JSON.stringify(this.data))}render(t){this.products_el.innerHTML="",this.products_el.innerHTML=this.catSKUs(t),this._imageObserver=new ImageObserver(this._productSection),this._imageObserver=null,this.listener(),location.href="#container"}process(t){t.map((t=>this.data.push(t))),t.map((t=>this.skus.push(t.sku))),this.current_page<=this.last_page&&(this.updateStatus(this.current_page,this.last_page,this.skus.length),this.current_page===this.last_page?this.attach():(this.current_page++,this.updateData()))}attachData(t){return localStorage.setItem("data",JSON.stringify(t)),this.preloader.classList.remove("-loading"),0!==t.length?this.process(t):this.collect(this.default_url),t}updateStatus(t,e,s){var i=this.status.querySelector(".-th-one"),r=this.status.querySelector(".-th-two"),a=this.status.querySelector(".-th-three"),h=this.status.querySelector(".-td-one"),o=this.status.querySelector(".-td-two"),l=this.status.querySelector(".-td-three");i.textContent=this.current_state.txt===this.FLAGS[0].txt?"page":"valid",r.textContent=this.current_state.txt===this.FLAGS[0].txt?"max. page":"OOS",a.textContent="total",h.textContent=t,o.textContent=e,l.textContent=s}isValidUrl(t){let e;try{e=new URL(t)}catch(t){return!1}return"http:"===e.protocol||"https:"===e.protocol}idx(t,e){return t=Math.ceil(t),e=Math.floor(e),Math.floor(Math.random()*(e-t))+t}unsuccessful(t){this.preloader.classList.remove("-loading"),this.attach()}randomIndex(t,e){return Math.floor(Math.random()*(e-t+1))+t}listener(){this.util.all(".-product .-close").forEach((t=>{var e=t.parentElement;t.addEventListener("click",(t=>{this.delete(e)})),this.preventAnchorDefault(e)}))}delete(t){var e=t.getAttribute("data-sku");this.skus=this.skus.filter((t=>t!==e)),this.products_el.removeChild(t),this.update(this.skus),this.dataCheckAndUpdate(e),this.statusCheckAndUpdate(this.PD)}preventAnchorDefault(t){t.querySelector(".-img").addEventListener("click",(t=>t.preventDefault()))}dataCheckAndUpdate(t){"oos"===this.data.find((e=>e.sku===t)).brand?this.temp_oos--:this.temp_valid--}update(t){this.textarea_c.value=t,this.textarea_n.value=t.join("\n")}debounce(t,e){var s=null;return function(){var i=this,r=arguments;clearTimeout(s),s=setTimeout((function(){t.apply(i,r)}),e)}}catSKUs(t){var e="";return t.map(((t,s)=>{var i=t.prices.discount?'<div class="-discount -inlineblock -vamiddle">'+t.prices.discount+"</div>":"",r=t.rating.average?'<div class="-rating -inlineblock -vamiddle">'+t.rating.average+" âœ¯</div>":"",a=s+1,h='<input type="number" class="-posabs -position" data-pos="'+a+'" value="'+a+'"/>',o=t.stock?`<div class="-stock -posabs">${t.stock.text}</div>`:"",l=this.sort_by_stock_wrap.classList;t.stock?l.remove("-hide"):l.add("-hide"),e+=`<div class="-product -inlineblock -vatop -posrel" data-sku="${t.sku}">${o}${h} <a class="-img" href="${this.domain}${t.url}"><img data-src="${t.image}" class="lazy-image" alt="floor product" /></a><div class="-discount-rating">${i} ${r} </div><div class="-name">${t.name}</div><div class="-prices"><div class="-price -new">${t.prices.price}</div><div class="-price -old">${t.prices.oldPrice?t.prices.oldPrice:""}</div></div><span class="-posabs -close"></span><div class="-sku-no">${t.sku}</div></div>`})),e}}class ImageObserver{constructor(t){this.images=t.querySelectorAll(".lazy-image"),this.observer=null;try{this.observer=new IntersectionObserver(this.onIntersection.bind(this),{}),this.images.forEach((t=>this.observer.observe(t)))}catch(t){this.images.forEach((t=>this.lazyLoadImage(t)))}}lazyLoadImage(t){var e=this;t.src?this.afterLoad(t,e):(t.src=t.getAttribute("data-src"),t.onload=()=>this.afterLoad(t,e))}afterLoad(t,e){t.classList.add("loaded"),e.removeLoaderBCompat(t)}removeLoaderBCompat(t){var e=t.parentElement.querySelector(".-preloader");e&&e.classList.remove("-loading")}onIntersection(t){t.forEach((t=>{t.isIntersecting&&(this.observer.unobserve(t.target),t.target.src=t.target.dataset.src,t.target.onload=()=>{t.target.classList.add("loaded"),this.removeLoader(t)})}))}removeLoader(t){var e=t.target.parentElement.querySelector(".-preloader");e&&e.classList.remove("-loading")}}if(window.innerWidth>600){var util=new Util;new SKUCollector(util)}