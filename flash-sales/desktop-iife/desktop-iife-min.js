var Begin=function(t){class s{constructor(t){this.json=t,this.SHEET_NAME="flash_sales",this.NAME="Flash Sale",this.TANDC="Flash Sale T & C",this.FOCUS="focus",this.BUILD="build",this.RESET="reset",this.TAB_OFFSET=63,this.TAB_LISTENER="tab listener",this.FIRST_TAB="first tab",this.IN_SESSION="in session",this.AFTER_SESSION="after session",this.BTW_OR_B4_SESSION="between or before session",this.SET_STATE="set state",this.TABS_PER_PAGE=6,this.TIME_SLOTS_TO_DISPLAY=12,this.SKU_X_MARGIN=4,this.time_interval=null,this.minute_duration=parseInt(t.config["minute_duration_"+this.SHEET_NAME]),this.CURRENCY=t.config.currency,this.config=t.config,this.domain=t.domain,this.el=t=>document.querySelector("#initiative "+t),this.all=t=>document.querySelectorAll("#initiative "+t),this.pad=t=>1==t.toString().length?"0"+t:t,this.endTime=t=>t+60*this.minute_duration*1e3,this.isAGroup=t=>0===t.fs_price.length,this.skuRow=t=>this.el('.-sku_row[data-time="'+t+'"]'),this.skuRows=()=>this.all(".-sku_row"),this.tab=t=>this.el('.-tab[data-time="'+t+'"]'),this.live=(t,s)=>t.forEach((t=>t.classList[s]("-live"))),this.skuID=t=>t.name+"-"+ +new Date(t.time),this.capitalize=t=>t[0].toUpperCase()+t.slice(1),this.oosByTime=t=>t.map((t=>this.skuRow(t).classList.add("-oos"))),this.getData=(t,s)=>{const i=t.json_list,e=s.key,a=s.name;return localStorage.setItem("list",JSON.stringify(i)),i.filter((t=>t[e]===a))},this.isItMyTime=(t,s)=>+new Date(t.time)===parseInt(s),this.isPast=t=>Date.now()>t&&Date.now()>this.endTime(t),this.isFuture=(t,s)=>-1===s.indexOf(t),this.displayCondition=(t,s)=>s<this.TIME_SLOTS_TO_DISPLAY,this.digit=(t,s)=>0!==parseInt(t)?this.pad(t)+s:"",this.isATab=t=>t.classList.contains("-tab")}times(t){var s=t.map((t=>+new Date(t.time)));return Array.from(new Set(s)).sort(((t,s)=>t-s))}group(t,s){return s.map((s=>{var i=t.filter((t=>this.isItMyTime(t,s)));return{time:s,skus:i}}))}pastAndFutureTimes(t){var s=t.filter(this.isPast),i=t.filter((t=>this.isFuture(t,s)));return{past:s,future:i}}additionalTimes(t){var s=t.future,i=t.past,e=this.addition(s,i);return s.length<this.TIME_SLOTS_TO_DISPLAY?e:[]}addition(t,s){for(var i=[],e=this.TIME_SLOTS_TO_DISPLAY-t.length;e>-1;e--){var a=s.length-1-e;i.push(s[a])}return i}timeUnits(t){var s=new Date(t);return{day:s.getDay(),month:s.getMonth(),date:s.getDate(),hr:s.getHours(),mn:s.getMinutes()}}twelveHrFormat(t,s){return 12===t?this.pad(t)+":"+this.pad(s)+"pm":t>12?this.pad(t-12)+":"+this.pad(s)+"pm":0===t?"12:"+this.pad(s)+"am":this.pad(t)+":"+this.pad(s)+"am"}date(t){var s=new Date(t).getDate(),i=new Date(Date.now()).getDate()-s;return 0===i?this.capitalize("today"):1===i?this.capitalize("yesterday"):-1===i?this.capitalize("tomorrow"):this.fullDate(t)}fullDate(t){var s=new Date(t),i=s.toLocaleDateString("en-US",{month:"short"});return s.toLocaleDateString("en-US",{weekday:"short"})+" "+i+" "+s.getDate()}toggleClass(t,s,i){t.forEach((t=>t.classList.remove(i))),s.classList.add(i)}price(t){return t.split("-").map(this.formatPrice.bind(this)).join(" - ")}formatPrice(t){var s="prefix"===this.config.currency_position?this.config.currency+" "+parseInt(t).toLocaleString():parseInt(t).toLocaleString()+" "+this.config.currency;return 0==parseInt(t)?"FREE":s}discount(t,s){var i=100*(parseInt(t)-parseInt(s))/parseInt(t);return isNaN(i)?"":"-"+Math.round(i)+"%"}replacePattern(t,s){var i=new RegExp(t,"g");return s.replace(i,"-")}id(t,s){var i=this.replacePattern("'",t),e=this.replacePattern("&",i);return this.replacePattern("%",e).toLowerCase().split(" ").join(s)}badge(t){var s=this.id(t.type,"_"),i=this.config[s+"_icon"],e="Generic"===t.type?"Limited Stock":t.type,a=i?`<img class="lazy-image" data-src="${i}" alt="sku_img"/>`:e;return i?`<div class="-tag -inlineblock -vamiddle -b-img -${this.id(t.type,"-")}">${a}</div>`:`<div class="-tag -inlineblock -vamiddle -${this.id(t.type,"-")}" style="background-color:${this.config[t.type]}">${a}</div>`}timeFormat(t){var s=this.timeUnits(t),i=this.twelveHrFormat(s.hr,s.mn);return this.date(t)+"'s "+i+" sale"}platform(){var t="ontouchstart"in window;const s=this.config[this.SHEET_NAME+"_mobile_banner"],i=this.config[this.SHEET_NAME+"_desktop_banner"],e=this.config[this.SHEET_NAME+"_deeplink"];return{banner:t?s:i,live_link:t?e:this.domain.host+"/"+this.config.download_apps_page}}show(t){return this.image_observer=new feature_box.ImageObserver(t),this.image_observer=null,this}}class i extends s{constructor(t){super(t),this.tab_bounds={},this.tabs=this.el(".-all-tabs"),this.tabs_parent=this.el(".-tabs"),this.prev=this.el(".-control.-prev"),this.next=this.el(".-control.-next"),feature_box.pubsub.subscribe(this.BUILD,this.build.bind(this)),this.tabs.addEventListener("click",this.tabListener.bind(this))}reset(){this.tab_bounds={},this.tabs.innerHTML=""}build(t){this.reset();var s=t.reordered_times;this.tabs.innerHTML=s.map(this.createTab.bind(this)).join(""),s.map(this.tabBounds.bind(this));var i=this.all(".-tab")[0];this.setTabProps(i,this.FIRST_TAB),this.show(this.tabs),!1===feature_box.is_mobile&&this.scrollListener()}scrollListener(){this.next.addEventListener("click",this.scrollToNext.bind(this)),this.prev.addEventListener("click",this.scrollToPrev.bind(this))}scrollToNext(){var t=this.tabs.scrollLeft+50,s=this.tabs.scrollLeft+300-t;this.tabs.scrollLeft=t+1*s}scrollToPrev(){var t=this.tabs.scrollLeft-50,s=this.tabs.scrollLeft-300-t;this.tabs.scrollLeft=t+1*s}tabListener(t){var s=t.target.parentElement;this.isATab(s)&&this.setTabProps(s,this.TAB_LISTENER)}setTabProps(t,s){this.toggleClass(this.all(".-tab"),t,"active"),s==this.TAB_LISTENER&&feature_box.pubsub.emit(this.FOCUS,t.getAttribute("data-time"))}tabBounds(t,s){var i=this.el('.-tab[data-time="'+t+'"]');this.tab_bounds[t]=i.getBoundingClientRect()}createTab(t,s){var i=0===s?"-tab active -inlineblock -posrel -vamiddle":"-tab -inlineblock -posrel -vamiddle",e=this.timeUnits(t);return`<a href="#top" class="${i}" data-time="${t}"><span class="-posabs -preloader -loading"></span><span class="-time">${this.twelveHrFormat(e.hr,e.mn)}</span><span>${this.date(t)}</span></a>`}}class e extends s{constructor(t){super(t),this.row_bounds={},this.skus_el=this.el(".-skus"),this.createSKUs=t=>t.map(this.skuHTML.bind(this)).join(""),this.skuHTML=t=>this.isAGroup(t)?this.groupHTML(t):this.singleHTML(t),feature_box.pubsub.subscribe(this.FOCUS,this.inFocus.bind(this)),feature_box.pubsub.subscribe(this.BUILD,this.display.bind(this))}reset(){this.row_bounds={},this.skus_el.innerHTML=""}inFocus(t){var s=this.skuRows(),i=this.skuRow(t);this.toggleClass(s,i,"active")}display(t){this.reset(),this.skus_el.innerHTML=t.grouped_skus.map(this.rowHTML.bind(this)).join("");var s=this.all(".-sku_row")[0].getAttribute("data-time");this.inFocus(s),feature_box.pubsub.emit(this.FOCUS,s),this.show(this.skus_el)}rowHTML(t,s){var i=this.createSKUs(t.skus);return this.createRow(t,s,i)}groupHTML(t){var s="Jumia Pay"===t.type?"buy now":"shop now";return`<a href="${t.pdp}" target="_blank" class="-sku -posrel -${t.status}" id="${this.id(this.skuID(t),"-")}"><div class="-img -posrel"><span class="-posabs -preloader -loading"></span><div class="-posabs -shadow"><span class="-posabs">sold out</span></div><img class="lazy-image" data-src="${t.image}" alt="sku_img"/></div><div class="-details -posabs"><div class="-name">${t.name.toString()}</div><div class="-prices"><div class="-price -new">${t.fs_discount}</div></div></div><div class="-cta -posabs">${s}</div><div class="-tags -posabs">${this.badge(t)}</div></a>`}singleHTML(t){var s=this.price(t.barred_price),i=this.price(t.fs_price),e=this.discount(t.barred_price,t.fs_price);return`<a href="${t.pdp}" target="_blank" class="-sku -posrel -${t.status}" id="${this.id(this.skuID(t),"-")}"><div class="-img -posrel"><span class="-posabs -preloader -loading"></span><div class="-posabs -shadow"><span class="-posabs">sold out</span></div><img class="lazy-image loaded" data-src="${t.image}" alt="sku_img"/></div><div class="-details -posabs"><div class="-name">${t.name}</div><div class="-prices"><div class="-price -new">${i}</div><div class="-price -old">${s}</div><div class="-discount">${e}</div></div></div><div class="-cta -posabs">add to cart</div><div class="-tags -posabs">${this.badge(t)}</div></a>`}createRow(t,s,i){return`<div class="${0===s?"-sku_row -posrel active":"-sku_row -posrel"}" data-time="${t.time}">${i}</div>`}}class a extends s{constructor(t){super(t),this.time_el=this.el(".-countdown-row .-time"),this.sessionEnded=t=>t.t<=0||t.session_state===this.AFTER_SESSION,this.amIInSession=t=>Date.now()>=t&&Date.now()<this.endTime(t),this.amIPastSession=t=>Date.now()>this.endTime(t),feature_box.pubsub.subscribe(this.FOCUS,this.inFocus.bind(this))}inFocus(t){var s=parseInt(t),i=this.endTime(s),e=this.sessionState(s);e===this.IN_SESSION&&this.liveActions(s);var a=e===this.IN_SESSION?i:s;this.initializeClock({session_state:e,time:a}),this.markSoldSKUs()}markSoldSKUs(){var t=Array.from(this.all(".-sku_row")).map((t=>parseInt(t.getAttribute("data-time")))),s=this.pastAndFutureTimes(t).past;this.oosByTime(s)}sessionState(t){var s="",i=this.amIInSession(t),e=this.amIPastSession(t);return s=i?this.IN_SESSION:"",""===(s=e?this.AFTER_SESSION:s)?this.BTW_OR_B4_SESSION:s}liveActions(t){var s=this.skuRow(t),i=this.tab(t);this.live([s,i],"add")}initializeClock(t){clearInterval(this.time_interval),this.time_interval=setInterval((()=>this.tick(t)),1e3)}tick(t){var s=this.remainingTime(t);s.session_state=t.session_state,this.sessionEnded(s)&&clearInterval(this.time_interval),this.updateClockUi(s)}updateClockUi(t){var s="";s=t.session_state===this.IN_SESSION?"Ends in ":"",s=t.session_state===this.AFTER_SESSION?"Ended last ":s,s=t.session_state===this.BTW_OR_B4_SESSION?"Starts in ":s;var i=this.digits(t).filter((t=>""!==t)).join(" : ");this.time_el.innerHTML=s+i}remainingTime(t){var s=t.time,i=+new Date(s)-Date.now();i=this.sessionEnded(t)?Date.now()-+new Date(s):i;var e=Math.floor(i/1e3%60),a=Math.floor(i/1e3/60%60),r=Math.floor(i/36e5%24),n=Math.floor(i/864e5);t={t:i,days:n,hours:r,minutes:a,seconds:e};return this.itIsEndTime(t)&&setTimeout((()=>feature_box.pubsub.emit(this.RESET,"from reset")),3e3),{t:i,days:n,hours:r,minutes:a,seconds:e}}itIsEndTime(t){return 0===t.days&&0===t.hours&&0===t.minutes&&0===t.seconds}digits(t){return t.days>=1?[this.digit(t.days,"d"),this.digit(t.hours,"h"),this.digit(t.minutes,"m")]:[this.digit(t.hours,"h"),this.digit(t.minutes,"m"),this.digit(t.seconds,"s")]}}new class extends s{constructor(t){super(t),this.data=this.getData(t,{key:"type",name:this.NAME}),this.tandcs=this.getData(t,{key:"type",name:this.TANDC}),this.tandc_el=this.el(".-re.-rules"),this.hiw_cta=document.querySelector(".-how-it-works"),this.hiw_cta.addEventListener("click",this.toggleBanner.bind(this)),this.top_banner=document.querySelector(".-banner.-top"),this.tabs=new i(t),this.sku_rows=new e(t),this.state=new a(t),feature_box.pubsub.subscribe(this.RESET,this.init.bind(this)),this.init("from start").setBanner().displayTAndCs().show()}init(t){var s=this.times(this.data),i=this.pastAndFutureTimes(s),e=this.additionalTimes(i).filter((t=>void 0!==t)),a=i.future.concat(e),r=this.group(this.data,a);return feature_box.pubsub.emit(this.BUILD,{reordered_times:a,grouped_skus:r}),this}toggleBanner(){this.top_banner.classList.toggle("-show");var t=this.hiw_cta.querySelector(".-txt");t.textContent="Terms & Conditions"===t.textContent?"Close":"Terms & Conditions"}setBanner(){return this.el(".-banner.-top img.lazy-image").setAttribute("data-src",this.platform().banner),this}displayTAndCs(){return this.tandc_el.innerHTML=this.tandcs.map(this.tandcHTML.bind(this)).join(""),this}tandcHTML(t){return`<div class="-rule_element"><div class="-inlineblock -vatop -num">${t.sku}.</div><div class="-inlineblock -vatop -desc">${t.name}</div></div>`}}(t)},gsheet_id="16AmKgEy2tHWRHgt9wdAfQJvgsML_pu_Z9PTH-_LvSjY",fb_config={apiKey:"AIzaSyAA8dQEt-yZnDyY3Lra8lndRJ3LWNYVW0o",authDomain:"jumia-c15a3.firebaseapp.com",databaseURL:"https://jumia-c15a3.firebaseio.com",projectId:"jumia-c15a3",storageBucket:"jumia-c15a3.appspot.com",messagingSenderId:"295115190934",appId:"1:295115190934:web:de0b33b53a514c3c"},element_id="app",feature_box=Featurebox({id:gsheet_id,config:fb_config,element_id:element_id,name:"flash_sales"});feature_box.pubsub.subscribe(feature_box.FETCHED_DATA,Begin);